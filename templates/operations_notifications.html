{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InspireWear | Notifications</title>
    <link rel="stylesheet" href="{% static 'operations.css' %}">
    <link rel="stylesheet" href="{% static 'operations_notifications.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
    <link rel="icon" href="{% static 'favicon.png' %}" type="image/x-icon">
</head>
<body>
    <!-- Loading Overlay -->
    <div class="morph-overlay" id="morphOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="loading-text">Loading Notifications...</p>
        </div>
    </div>

    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="logo-container">
            <img src="{% static 'logo.png' %}" alt="InspireWear Logo" class="logo">
            <h1 class="logo-text">InspireWear</h1>
        </div>

        <a href="{% url 'index' %}" class="home-button">
            <i class="fas fa-arrow-left"></i> Back to Home
        </a>

        <div class="module-heading">
            <span class="star">✧</span>
            <h1>OPERATIONS</h1>
            <span class="star">✧</span>
        </div>

        <nav class="operations-nav">
            <ul>
                <li><a href="{% url 'operations_dashboard' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="{% url 'staff_scheduling' %}"><i class="fas fa-calendar-alt"></i> Staff Scheduling</a></li>
                <li><a href="{% url 'returns_exchanges' %}"><i class="fas fa-exchange-alt"></i> Returns & Exchanges</a></li>
                <li><a href="{% url 'task_management' %}"><i class="fas fa-tasks"></i> Tasks</a></li>
                <li class="active"><a href="{% url 'operations_notifications' %}"><i class="fas fa-bell"></i> Notifications</a></li>
                <li><a href="{% url 'operations_reports' %}"><i class="fas fa-chart-pie"></i> Reports</a></li>
            </ul>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="operations-header">
            <h2>Notifications Center</h2>
            <div class="header-actions">
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <i class="fas fa-moon theme-icon"></i>
                </button>
                <div class="profile-container">
                    <button class="profile-btn" id="profileBtn" aria-label="User profile" aria-expanded="false">
                        <img src="{% static 'user.png' %}" alt="Profile" class="profile-img">
                        <span>Operations Manager</span>
                    </button>
                    <div class="profile-dropdown" id="profileDropdown">
                        <a href="{% url 'index' %}" class="dropdown-item">
                            <i class="fas fa-home"></i> Back to Home
                        </a>
                        <a href="{% url 'login' %}" class="dropdown-item">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Overview Cards -->
        <div class="overview-cards">
            <div class="card total-notifications">
                <div class="card-icon">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="card-content">
                    <h3>Total Notifications</h3>
                    <p class="amount"><span id="totalNotifications">47</span></p>
                    <p class="change positive"><i class="fas fa-arrow-up"></i> 8 new today</p>
                </div>
            </div>

            <div class="card unread-notifications">
                <div class="card-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="card-content">
                    <h3>Unread</h3>
                    <p class="amount"><span id="unreadNotifications">12</span></p>
                    <p class="change negative"><i class="fas fa-arrow-up"></i> 3 urgent</p>
                </div>
            </div>

            <div class="card sent-notifications">
                <div class="card-icon">
                    <i class="fas fa-paper-plane"></i>
                </div>
                <div class="card-content">
                    <h3>Sent Today</h3>
                    <p class="amount"><span id="sentToday">6</span></p>
                    <p class="change positive"><i class="fas fa-arrow-up"></i> 2 more than yesterday</p>
                </div>
            </div>

            <div class="card response-rate">
                <div class="card-icon">
                    <i class="fas fa-reply"></i>
                </div>
                <div class="card-content">
                    <h3>Response Rate</h3>
                    <p class="amount"><span id="responseRate">89</span>%</p>
                    <p class="change positive"><i class="fas fa-arrow-up"></i> 4% increase</p>
                </div>
            </div>
        </div>

        <!-- Module Communication Overview -->
        <div class="module-overview">
            <h3>Module Communication Status</h3>
            <div class="module-cards">
                <div class="module-card inventory">
                    <div class="module-icon">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="module-info">
                        <h4>Inventory</h4>
                        <p class="module-status online">Online</p>
                        <p class="last-activity">Last activity: 5 min ago</p>
                    </div>
                    <div class="module-stats">
                        <span class="unread-count">3</span>
                    </div>
                </div>

                <div class="module-card finance">
                    <div class="module-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="module-info">
                        <h4>Finance</h4>
                        <p class="module-status online">Online</p>
                        <p class="last-activity">Last activity: 2 min ago</p>
                    </div>
                    <div class="module-stats">
                        <span class="unread-count">5</span>
                    </div>
                </div>

                <div class="module-card online-shop">
                    <div class="module-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="module-info">
                        <h4>Online Shop</h4>
                        <p class="module-status online">Online</p>
                        <p class="last-activity">Last activity: 1 min ago</p>
                    </div>
                    <div class="module-stats">
                        <span class="unread-count">4</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Controls -->
        <div class="action-controls">
            <div class="filter-controls">
                <select id="moduleFilter" class="filter-select">
                    <option value="">All Modules</option>
                    <option value="inventory">Inventory</option>
                    <option value="finance">Finance</option>
                    <option value="online-shop">Online Shop</option>
                </select>
                <select id="typeFilter" class="filter-select">
                    <option value="">All Types</option>
                    <option value="alert">Alerts</option>
                    <option value="update">Updates</option>
                    <option value="request">Requests</option>
                    <option value="reminder">Reminders</option>
                </select>
                <select id="statusFilter" class="filter-select">
                    <option value="">All Status</option>
                    <option value="unread">Unread</option>
                    <option value="read">Read</option>
                </select>
                <button id="clearFilters" class="btn-secondary"><i class="fas fa-times"></i> Clear</button>
            </div>
            <div class="action-buttons">
                <button id="composeBtn" class="btn-primary"><i class="fas fa-plus"></i> Compose</button>
                <button id="markAllReadBtn" class="btn-secondary"><i class="fas fa-check-double"></i> Mark All Read</button>
                <button id="refreshBtn" class="btn-secondary"><i class="fas fa-sync-alt"></i> Refresh</button>
            </div>
        </div>

        <!-- Notifications List -->
        <div class="notifications-container">
            <div class="notifications-header">
                <h3>Recent Notifications</h3>
                <div class="view-toggle">
                    <button id="inboxBtn" class="view-btn active">
                        <i class="fas fa-inbox"></i> Inbox
                    </button>
                    <button id="sentBtn" class="view-btn">
                        <i class="fas fa-paper-plane"></i> Sent
                    </button>
                </div>
            </div>

            <!-- Inbox View -->
            <div id="inboxView" class="notifications-list">
                <!-- Notifications will be loaded here by JavaScript -->
            </div>

            <!-- Sent View -->
            <div id="sentView" class="notifications-list" style="display: none;">
                <!-- Sent notifications will be loaded here by JavaScript -->
            </div>
        </div>

        <!-- Footer -->
        <footer class="operations-footer">
            <div class="footer-content">
                <p class="footer-text">© 2025 InspireWear. All rights reserved.</p>
                <div class="footer-links">
                    <a href="#" class="footer-link">Terms</a>
                    <a href="#" class="footer-link">Privacy</a>
                    <a href="#" class="footer-link">Contact</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Compose Notification Modal -->
    <div class="modal-overlay" id="composeModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Compose Notification</h3>
                <button class="modal-close" id="composeModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <form id="composeForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="recipientModule">To Module</label>
                            <select id="recipientModule" required>
                                <option value="">Select Module</option>
                                <option value="inventory">Inventory</option>
                                <option value="finance">Finance</option>
                                <option value="online-shop">Online Shop</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="notificationType">Type</label>
                            <select id="notificationType" required>
                                <option value="">Select Type</option>
                                <option value="alert">Alert</option>
                                <option value="update">Update</option>
                                <option value="request">Request</option>
                                <option value="reminder">Reminder</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="priority">Priority</label>
                            <select id="priority" required>
                                <option value="">Select Priority</option>
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="urgent">Urgent</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subject">Subject</label>
                            <input type="text" id="subject" required placeholder="Enter notification subject">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" rows="4" required placeholder="Enter your message..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="tags">Tags (comma separated)</label>
                        <input type="text" id="tags" placeholder="e.g., urgent, stock-alert, payment">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancelCompose">Cancel</button>
                        <button type="submit" class="btn-primary">Send Notification</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification Details Modal -->
    <div class="modal-overlay" id="detailsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="detailsModalTitle">Notification Details</h3>
                <button class="modal-close" id="detailsModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div id="detailsContent">
                    <!-- Details will be populated by JavaScript -->
                </div>
                <div class="quick-actions">
                    <h4>Quick Actions</h4>
                    <div class="action-buttons">
                        <button id="markReadBtn" class="btn-success">
                            <i class="fas fa-check"></i> Mark as Read
                        </button>
                        <button id="replyBtn" class="btn-primary">
                            <i class="fas fa-reply"></i> Reply
                        </button>
                        <button id="deleteNotificationBtn" class="btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reply Modal -->
    <div class="modal-overlay" id="replyModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="replyModalTitle">Reply to Notification</h3>
                <button class="modal-close" id="replyModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="original-message" id="originalMessage">
                    <!-- Original message will be shown here -->
                </div>
                <form id="replyForm">
                    <div class="form-group">
                        <label for="replyMessage">Your Reply</label>
                        <textarea id="replyMessage" rows="4" required placeholder="Enter your reply..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancelReply">Cancel</button>
                        <button type="submit" class="btn-primary">Send Reply</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="{% static 'operations_notifications.js' %}"></script>
</body>
</html>